import pandas as pd

# Load input files
condition_df = pd.read_csv("../data/processed_data/road_condition_categorized.csv")

erosion_df = pd.read_csv("../data/processed_data/average_erosion_score_per_road.csv")[["road", "avg_erosion_score"]]
flood_df = pd.read_csv("../data/processed_data/road_flood_scores.csv")[["road", "normalized_score"]]
earthquake_df = pd.read_csv("../data/processed_data/avg_earthquake_score.csv")

# Convert avg_erosion_score to numeric and report non-numeric entries
erosion_df["avg_erosion_score"] = pd.to_numeric(erosion_df["avg_erosion_score"], errors="coerce")



# Merge all on 'road' column
merged_df = condition_df.merge(erosion_df, on="road", how="left")
merged_df = merged_df.merge(flood_df, on="road", how="left")
merged_df = merged_df.merge(earthquake_df, on="road", how="left")


print(f"Rows after merging: {len(merged_df)}") #check nothing is lost



# Preview merged result
print(merged_df)

#save input file
output_path = "../data/processed_data/input_road_vulnerability.csv"
merged_df.to_csv(output_path, index=False)
 