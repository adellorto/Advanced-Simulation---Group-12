# Simple Transport Model Demo in MESA

Created by:
Yilin HUANG

Continued by Group 12 of EPA133a Advanced Simulation course (2024-2025)

Email:
y.huang@tudelft.nl

Version:
1.2

## Introduction

A simple transport model demo in MESA for EPA133a Advanced Simulation course Assignment 2.

## How to Use

- Create and activate a virtual environment

In PyCharm, you can create a virtual environment by following the steps below:

    1. Open the project in PyCharm
    2. Go to Settings -> Project: epa133a -> Python Interpreter
    3. Click "Add Interpreter"
    4. Select "Add Local Interpreter"
    5. Select Virtualenv Environment
    6. Select New environment
    7. Select Base interpreter as Python 3.11
    8. Click OK and also close the settings with OK

Afterwards, you should see "Python 3.11" (epa133a) in the bottom-right corner of the PyCharm window.
To install the requirements, open a terminal/command line window in PyCharm and type:

```
    $ pip install -r requirements.txt
```

- Launch the simulation model with visualization

```
    $ python model_viz.py
```

- Launch the simulation model without visualization

```
    $ python model_run.py
```

## Files

- [model.py](model.py): Contains the model `BangladeshModel` which is a subclass of Mesa `Model`. It reads a `csv` file with specific format for (transport) model generation. (See the README in the `data` directory for data format.) In addition to dynamic behavior, each model component instance (i.e., object) also has geo-location variables, i.e. latitude and longitude in Decimal Degrees (DD). The given bounds of the latitude and longitude of all objects are translated into the bounds of the HTML5 canvas, which is used in case the visualization is launched.

  In this file, you modify the model generation and add your own routines. 
  
- [components.py](components.py): Contains the model component definitions for the (main) model. Check the file carefully to see which components are already defined.

  In this file, you modify and add your own components.

- [model_viz.py](model_viz.py): Sets up the visualization; uses the `SimpleCanvas` element defined. Calls the model. Run the visualization server.

  In this file, you define simple visualization.

- [model_run.py](model_run.py): Sets up the model run (conditions). Calls the model. Run the simulation without visualization.

  In this file, you define model batch runs. The finalised version of this script saves the outputs of each simulation in the directory  'experiment' as a .csv file. 
  This script is also where you can control the scenario of the simulation and test its robustness by modifying the seed.

- [data_pull.py](data_pull.py): Contains the data pull routines for the model. The data pull routines takes processed input from the real world and produces a fitting `.csv` file for the model. 

  In this file, you define the data pull routines in case your real-world data has a different arrangement from the Bangladesh network of roads. Here we can also select which is the road of interest for the model generation.

- [ContinuousSpace](ContinuousSpace): The directory contains files needed to visualize Python3 Mesa models on a continuous canvas with geo-coordinates, a functionality not contained in the current Mesa package.

  Editing files in this directory is NOT recommended for our assignment.

- [ContinuousSpace/SimpleContinuousModule.py](ContinuousSpace/SimpleContinuousModule.py): Defines `SimpleCanvas`, the Python side of a custom visualization module for drawing objects with continuous positions. This is a slight adaptation of the Flocker example provided by the Mesa project.

  Editing this file is NOT recommended for our assignment.

- [ContinuousSpace/simple_continuous_canvas.js](ContinuousSpace/simple_continuous_canvas.js): JavaScript side of the `SimpleCanvas` visualization module. It takes the output generated by the Python `SimpleCanvas` element and draws it in the browser window via HTML5 canvas. It can draw circles and rectangles. Both can have text annotation. This file is an adaptation of the Flocker example provided by the Mesa project.

  Editing this file is NOT recommended for our assignment.
